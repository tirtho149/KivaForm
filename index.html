<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sustainability Communication Assessment</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState } = React;

    // Lucide Icons as inline SVG
    const AlertCircle = () => (
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <circle cx="12" cy="12" r="10"></circle>
        <line x1="12" y1="8" x2="12" y2="12"></line>
        <line x1="12" y1="16" x2="12.01" y2="16"></line>
      </svg>
    );

    const CheckCircle = () => (
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
        <polyline points="22 4 12 14.01 9 11.01"></polyline>
      </svg>
    );

    const Loader2 = () => (
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="animate-spin">
        <path d="M21 12a9 9 0 1 1-6.219-8.56"></path>
      </svg>
    );

    const SustainabilityForm = () => {
      const [formData, setFormData] = useState({
        economicCredibility: '',
        environmentalCredibility: '',
        socialCredibility: '',
        economicEmotional: '',
        environmentalEmotional: '',
        socialEmotional: '',
        economicLogic: '',
        environmentalLogic: '',
        socialLogic: '',
        economicTiming: '',
        environmentalTiming: '',
        socialTiming: ''
      });

      const [status, setStatus] = useState({ type: '', message: '' });
      const [isSubmitting, setIsSubmitting] = useState(false);

      // Google Apps Script Web App URL
      const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyh999bwYvEFyB77ipR8L3LLQPFhWiTl62gX72iEdxdl2vTMO0Gr1Q97XdU4jRj3nmeRw/exec';

      const assessmentCategories = {
        'Credibility': 'Appeals based on source expertise, trustworthiness, and authority',
        'Emotional Appeal': 'Appeals to emotions, values, and personal connections',
        'Logic': 'Appeals based on rational arguments, data, and evidence',
        'Timing': 'Strategic timing of message delivery for maximum impact'
      };

      const sustainabilityCategories = {
        'Economic': 'Financial viability, cost-effectiveness, and economic benefits',
        'Environmental': 'Ecological impact, resource conservation, and environmental protection',
        'Social': 'Community welfare, equity, and social responsibility'
      };

      const ratingDescriptions = {
        '1': 'Very Weak',
        '2': 'Weak',
        '3': 'Strong',
        '4': 'Very Strong'
      };

      const handleChange = (field, value) => {
        setFormData(prev => ({ ...prev, [field]: value }));
      };

      const handleSubmit = async () => {
        setIsSubmitting(true);
        setStatus({ type: '', message: '' });

        // Validate all fields are filled
        const emptyFields = Object.entries(formData).filter(([_, value]) => !value);
        if (emptyFields.length > 0) {
          setStatus({ 
            type: 'error', 
            message: 'Please fill in all fields before submitting.' 
          });
          setIsSubmitting(false);
          return;
        }

        try {
          const submission = {
            timestamp: new Date().toISOString(),
            ratings: {
              credibility: {
                economic: formData.economicCredibility,
                environmental: formData.environmentalCredibility,
                social: formData.socialCredibility
              },
              emotionalAppeal: {
                economic: formData.economicEmotional,
                environmental: formData.environmentalEmotional,
                social: formData.socialEmotional
              },
              logic: {
                economic: formData.economicLogic,
                environmental: formData.environmentalLogic,
                social: formData.socialLogic
              },
              timing: {
                economic: formData.economicTiming,
                environmental: formData.environmentalTiming,
                social: formData.socialTiming
              }
            }
          };

          const response = await fetch(APPS_SCRIPT_URL, {
            method: 'POST',
            mode: 'no-cors',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify(submission)
          });

          // Note: With no-cors mode, we can't read the response
          // But if we get here without error, it likely worked
          setStatus({ 
            type: 'success', 
            message: 'Form submitted successfully! Your response has been recorded in the Google Sheet.' 
          });
          
          // Reset form
          setFormData({
            economicCredibility: '',
            environmentalCredibility: '',
            socialCredibility: '',
            economicEmotional: '',
            environmentalEmotional: '',
            socialEmotional: '',
            economicLogic: '',
            environmentalLogic: '',
            socialLogic: '',
            economicTiming: '',
            environmentalTiming: '',
            socialTiming: ''
          });

        } catch (error) {
          setStatus({ 
            type: 'error', 
            message: 'Failed to submit form. Please try again.' 
          });
        } finally {
          setIsSubmitting(false);
        }
      };

      return (
        <div className="min-h-screen bg-gradient-to-br from-green-50 to-blue-50 p-4 md:p-8">
          <div className="max-w-5xl mx-auto bg-white rounded-xl shadow-lg p-6 md:p-8">
            <h1 className="text-3xl font-bold text-gray-800 mb-2">
              Sustainability Communication Assessment
            </h1>
            <p className="text-gray-600 mb-8">
              Rate the effectiveness of communication strategies across different sustainability dimensions
            </p>

            <div className="space-y-8">
              {/* Rating Grid */}
              <div className="overflow-x-auto">
                <table className="w-full border-collapse">
                  <thead>
                    <tr className="bg-gray-100">
                      <th className="border-2 border-gray-300 p-4 text-left font-semibold">
                        Assessment Category
                      </th>
                      {Object.entries(sustainabilityCategories).map(([category, description]) => (
                        <th key={category} className="border-2 border-gray-300 p-4 text-center relative group">
                          <div className="font-semibold mb-1 cursor-help">{category}</div>
                          <div className="absolute left-1/2 transform -translate-x-1/2 top-full mt-2 w-64 bg-gray-800 text-white text-xs p-3 rounded-lg shadow-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none z-10">
                            {description}
                            <div className="absolute bottom-full left-1/2 transform -translate-x-1/2 border-8 border-transparent border-b-gray-800"></div>
                          </div>
                        </th>
                      ))}
                    </tr>
                  </thead>
                  <tbody>
                    {/* Credibility Row */}
                    <tr className="hover:bg-gray-50">
                      <td className="border-2 border-gray-300 p-4 font-medium bg-gray-50 relative group">
                        <div className="font-semibold text-lg cursor-help">Credibility</div>
                        <div className="absolute left-full ml-2 top-1/2 transform -translate-y-1/2 w-72 bg-gray-800 text-white text-sm p-3 rounded-lg shadow-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none z-10">
                          {assessmentCategories['Credibility']}
                          <div className="absolute right-full top-1/2 transform -translate-y-1/2 border-8 border-transparent border-r-gray-800"></div>
                        </div>
                      </td>
                      {['economic', 'environmental', 'social'].map((category) => (
                        <td key={category} className="border-2 border-gray-300 p-4">
                          <select
                            value={formData[`${category}Credibility`]}
                            onChange={(e) => handleChange(`${category}Credibility`, e.target.value)}
                            className="w-full p-2 border-2 border-gray-200 rounded focus:ring-2 focus:ring-blue-500"
                          >
                            <option value="">Select rating...</option>
                            {Object.entries(ratingDescriptions).map(([value, label]) => (
                              <option key={value} value={value}>{value} - {label}</option>
                            ))}
                          </select>
                        </td>
                      ))}
                    </tr>

                    {/* Emotional Appeal Row */}
                    <tr className="hover:bg-gray-50">
                      <td className="border-2 border-gray-300 p-4 font-medium bg-gray-50 relative group">
                        <div className="font-semibold text-lg cursor-help">Emotional Appeal</div>
                        <div className="absolute left-full ml-2 top-1/2 transform -translate-y-1/2 w-72 bg-gray-800 text-white text-sm p-3 rounded-lg shadow-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none z-10">
                          {assessmentCategories['Emotional Appeal']}
                          <div className="absolute right-full top-1/2 transform -translate-y-1/2 border-8 border-transparent border-r-gray-800"></div>
                        </div>
                      </td>
                      {['economic', 'environmental', 'social'].map((category) => (
                        <td key={category} className="border-2 border-gray-300 p-4">
                          <select
                            value={formData[`${category}Emotional`]}
                            onChange={(e) => handleChange(`${category}Emotional`, e.target.value)}
                            className="w-full p-2 border-2 border-gray-200 rounded focus:ring-2 focus:ring-blue-500"
                          >
                            <option value="">Select rating...</option>
                            {Object.entries(ratingDescriptions).map(([value, label]) => (
                              <option key={value} value={value}>{value} - {label}</option>
                            ))}
                          </select>
                        </td>
                      ))}
                    </tr>

                    {/* Logic Row */}
                    <tr className="hover:bg-gray-50">
                      <td className="border-2 border-gray-300 p-4 font-medium bg-gray-50 relative group">
                        <div className="font-semibold text-lg cursor-help">Logic</div>
                        <div className="absolute left-full ml-2 top-1/2 transform -translate-y-1/2 w-72 bg-gray-800 text-white text-sm p-3 rounded-lg shadow-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none z-10">
                          {assessmentCategories['Logic']}
                          <div className="absolute right-full top-1/2 transform -translate-y-1/2 border-8 border-transparent border-r-gray-800"></div>
                        </div>
                      </td>
                      {['economic', 'environmental', 'social'].map((category) => (
                        <td key={category} className="border-2 border-gray-300 p-4">
                          <select
                            value={formData[`${category}Logic`]}
                            onChange={(e) => handleChange(`${category}Logic`, e.target.value)}
                            className="w-full p-2 border-2 border-gray-200 rounded focus:ring-2 focus:ring-blue-500"
                          >
                            <option value="">Select rating...</option>
                            {Object.entries(ratingDescriptions).map(([value, label]) => (
                              <option key={value} value={value}>{value} - {label}</option>
                            ))}
                          </select>
                        </td>
                      ))}
                    </tr>

                    {/* Timing Row */}
                    <tr className="hover:bg-gray-50">
                      <td className="border-2 border-gray-300 p-4 font-medium bg-gray-50 relative group">
                        <div className="font-semibold text-lg cursor-help">Timing</div>
                        <div className="absolute left-full ml-2 top-1/2 transform -translate-y-1/2 w-72 bg-gray-800 text-white text-sm p-3 rounded-lg shadow-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none z-10">
                          {assessmentCategories['Timing']}
                          <div className="absolute right-full top-1/2 transform -translate-y-1/2 border-8 border-transparent border-r-gray-800"></div>
                        </div>
                      </td>
                      {['economic', 'environmental', 'social'].map((category) => (
                        <td key={category} className="border-2 border-gray-300 p-4">
                          <select
                            value={formData[`${category}Timing`]}
                            onChange={(e) => handleChange(`${category}Timing`, e.target.value)}
                            className="w-full p-2 border-2 border-gray-200 rounded focus:ring-2 focus:ring-blue-500"
                          >
                            <option value="">Select rating...</option>
                            {Object.entries(ratingDescriptions).map(([value, label]) => (
                              <option key={value} value={value}>{value} - {label}</option>
                            ))}
                          </select>
                        </td>
                      ))}
                    </tr>
                  </tbody>
                </table>
              </div>

              {/* Status Messages */}
              {status.message && (
                <div className={`flex items-start gap-2 p-4 rounded-lg ${
                  status.type === 'success' ? 'bg-green-50 text-green-800' : 'bg-red-50 text-red-800'
                }`}>
                  <div className="flex-shrink-0 mt-0.5">
                    {status.type === 'success' ? <CheckCircle /> : <AlertCircle />}
                  </div>
                  <span className="break-words">{status.message}</span>
                </div>
              )}

              {/* Submit Button */}
              <button
                onClick={handleSubmit}
                disabled={isSubmitting}
                className="w-full bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white font-semibold py-4 px-6 rounded-lg transition-colors flex items-center justify-center gap-2"
              >
                {isSubmitting ? (
                  <>
                    <Loader2 />
                    Submitting...
                  </>
                ) : (
                  'Submit Assessment'
                )}
              </button>
            </div>
          </div>
        </div>
      );
    };

    ReactDOM.render(<SustainabilityForm />, document.getElementById('root'));
  </script>
</body>
</html>
